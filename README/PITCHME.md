---
theme : "white"
transition : "default"
---
# ![ã„ããªã‚Šã‚³ãƒˆãƒªãƒ³_and_MVVM_and_DataBinding](./img/title.jpg)
#### VMTé–‹ç™ºéƒ¨ã€€èµ¤å€‰ å¥ˆç·’

---

## ã“ã®å‹‰å¼·ä¼šã§ã‚„ã‚‹ã“ã¨

- Kotlinã§â€¦â€¦
  - ä¸­é€”æ¡ç”¨è€…å‘ã‘ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚¢ãƒ—ãƒª(ã‚«ãƒ¼ã‚»ãƒ³ã‚µãƒ¼ä¸­å¤è»Šæ¤œç´¢ã‚¢ãƒ—ãƒª)ã‚’ä½œæˆã™ã‚‹
  - ã¡ã‚‡ã£ã¨é›£ã—ã„ã‘ã©
  - `MVVM` ã¨
  - `DataBinding` ã¨
  - `ViewBinding` ã‚‚ä½¿ã†

---

## ã“ã®å‹‰å¼·ä¼šã§ã‚„ã£ã¦ã»ã—ã„ã“ã¨

- Kotlinã¡ã‚‡ã£ã¨ã§ã‚‚è¦šãˆã‚‹
- `MVVM` ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«è§¦ã‚Œã‚‹
- ã¤ã„ã§ã«Androidã® `DataBinding` ã¨ `ViewBinding` ã«ã‚‚è§¦ã‚Œã¦ã¿ã‚‹

---

## ã‚¢ã‚¸ã‚§ãƒ³ãƒ€

- ç”¨æ„ã™ã‚‹ã‚‚ã®
- ã¨ã‚Šã‚ãˆãšå®Œæˆç‰©ã®ç¢ºèª
- MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®èª¬æ˜
- `DataBinding` / `ViewBinding` ã®èª¬æ˜
- å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç”¨æ„

---

## ã‚¢ã‚¸ã‚§ãƒ³ãƒ€

- APIé€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`Repository`) ã®ä½œæˆ
- æœ€åˆã®ãƒ“ãƒ¥ãƒ¼ (`MainFragment` / `MainViewModel`) ã®ä½œæˆ
- 2ã¤ã‚ã®ãƒ“ãƒ¥ãƒ¼ (`UsedCarDetailFragment` / `UsedCarDetailViewModel`) ã®ä½œæˆ
- å‚è€ƒè³‡æ–™ç­‰

---

## ã‚„ã‚‹ã“ã¨ã‚‚ã‚Šã‚‚ã‚Šï¼

---

## ç”¨æ„ã™ã‚‹ã‚‚ã®

---

## ç”¨æ„ã™ã‚‹ã‚‚ã®

### AndroidStudioãŒå‹•ãPC 

- macOSã§ã‚‚
- Windowsã§ã‚‚
- ãŠå¥½ããªLinuxã§ã‚‚
- AndroidStudioãŒå‹•ã‘ã°ãªã‚“ã§ã‚‚ã„ã„ã§ã™
- `AVD Manager` ã‚‚å‹•ã‘ã‚‹ç’°å¢ƒãŒå¥½ã¾ã—ã„ã§ã™(OR å®Ÿæ©Ÿã§ãƒ‡ãƒãƒƒã‚°ã )

---

## ç”¨æ„ã™ã‚‹ã‚‚ã®

### AndroidStudio

- `AVD Manager` ã§ãƒ‡ãƒãƒƒã‚°ç”¨ã®ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆãƒã‚·ãƒ³ã‚‚ç”¨æ„ã—ã¦ãŠãã¨GOODã§ã™ã­ï¼

---

## ç”¨æ„ã™ã‚‹ã‚‚ã®

### ãƒ‡ãƒãƒƒã‚°ç”¨å®Ÿæ©Ÿã¾ãŸã¯ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆãƒã‚·ãƒ³

- `AVD Manager` ã§ç”¨æ„ã§ãã¾ã™ï¼

![AVDãƒãƒãƒ¼ã‚¸ãƒ£ã®å ´æ‰€](./img/0-0.png)

---

## ç”¨æ„ã™ã‚‹ã‚‚ã®

### ãƒ‡ãƒãƒƒã‚°ç”¨å®Ÿæ©Ÿã¾ãŸã¯ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆãƒã‚·ãƒ³

- `AVD Manager` ã§ç”¨æ„ã§ãã¾ã™ï¼

![AVDãƒãƒãƒ¼ã‚¸ãƒ£ã®å ´æ‰€](./img/0-1.png)

---

## ç”¨æ„ã™ã‚‹ã‚‚ã®

### ã‚«ãƒ¼ã‚»ãƒ³ã‚µãƒ¼APIã‚¢ã‚¯ã‚»ã‚¹ç”¨ãƒˆãƒ¼ã‚¯ãƒ³ã®å–å¾—
- ä»¥ä¸‹ã‹ã‚‰ç™»éŒ²ã‚’è¡Œã£ã¦ãŠã„ã¦ãã ã•ã„
  - https://webservice.recruit.co.jp/register/ 
- å¿˜ã‚ŒãŸæ–¹ã¯ ~~-ä»•æ–¹ãªã~~ èµ¤å€‰ã®æŒã£ã¦ã„ã‚‹IDã‚’é…å¸ƒã—ã¾ã™ã®ã§ã€ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„

---

## ã¨ã‚Šã‚ãˆãšå®Œæˆç‰©ã®ç¢ºèª

---

## ã¨ã‚Šã‚ãˆãšå®Œæˆç‰©ã®ç¢ºèª

- ã“ã¡ã‚‰ã«ã™ã§ã«ä½œæˆæ¸ˆã¿ã®ã‚¢ãƒ—ãƒªãŒå­˜åœ¨ã—ã¦ã„ã¾ã™

- ã‚ˆã‚ã—ã‘ã‚Œã°ã€ã©ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ãªã®ã‹ã€ã©ã®ã‚ˆã†ãªæŒ™å‹•ã‚’ã™ã‚‹ã‚¢ãƒ—ãƒªãªã®ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¦ãã ã•ã„

https://github.com/cocoalix/CarsensorApp

---

## MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®èª¬æ˜

---

## MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®èª¬æ˜

### MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã¯

- Model-View-ViewModel Architecture
- GUIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…æ‰‹æ³•ã®ã²ã¨ã¤
- MVCã®æ´¾ç”Ÿãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã‚ã‚Šã€Œãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’åˆ†é›¢ã€ã™ã‚‹
  - ã“ã®æ‰‹æ³•ã«ã‚ˆã£ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã«ãŠã‘ã‚‹ä¿å®ˆæ€§ãƒ»é–‹ç™ºç”Ÿç”£æ€§ã«å¯„ä¸ã™ã‚‹

---

### MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã¯

#### Model

- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã® ãƒ‰ãƒ¡ã‚¤ãƒ³(å•é¡Œé ˜åŸŸ) ã‚’å–ã‚Šæ‰±ã†
- ãã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ‰±ã†é ˜åŸŸã®ãƒ‡ãƒ¼ã‚¿ã¨æ‰‹ç¶šã(ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯)ã‚’è¡¨ç¾ã™ã‚‹è¦ç´ 
  - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯(ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ã®åˆè¨ˆé¡ã‚„é€æ–™ã‚’è¨ˆç®—ã™ã‚‹ãªã©ï¼‰

---

### MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã¯

#### Model

- å¤šãã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯DBã‚¢ã‚¯ã‚»ã‚¹ã‚„ã‚µãƒ¼ãƒå´ã¨ã®é€šä¿¡ãƒ­ã‚¸ãƒƒã‚¯ãªã©ãŒå«ã¾ã‚Œã¦ã„ã‚‹
- MVVMã®æ¦‚å¿µã§ã¯MVCã®æ¦‚å¿µã¨åŒæ§˜ã«ã€ãƒ‡ãƒ¼ã‚¿ã®ï¼ˆUIä»¥å¤–ã®ï¼‰å…¥å‡ºåŠ›ã¯å–ã‚Šæ‰±ã‚ãªã„ã®ã§ã€å¼·ã„ã¦è¨€ã†ãªã‚‰ã°ãã‚Œã‚‰ã¯Modelã®ä¸­ã«éš è”½ã•ã‚Œã‚‹ã¨è€ƒãˆã‚‰ã‚Œã‚‹

---

### MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã¯

#### Model

- ä¸€èˆ¬çš„ã«Modelã¯ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’æ‹…å½“ã™ã‚‹ã¨è¨€ã‚ã‚Œã‚‹ãŒã“ã®è¨€è‘‰ã ã‘ã‚’ã‚‚ã£ã¦Modelã®å½¹å‰²ã‚’æƒ³åƒã™ã‚‹ã®ã¯é›£ã—ã„
- Modelã®å½¹å‰²ã¯ã€å¾Œè¿°ã™ã‚‹Viewã¨ViewModelã®å½¹å‰²ä»¥å¤–ã®éƒ¨åˆ†ã¨è€ƒãˆã‚‹ã®ãŒå¦¥å½“

---

### MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã¯

#### View

- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ‰±ã†ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã‚‹ã®ã«é©ã—ãŸå½¢ã§è¡¨ç¤ºã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®å…¥åŠ›ã‚’å—ã‘å–ã‚‹è¦ç´ 
- ã™ãªã‚ã¡UIã¸ã®å…¥åŠ›ã¨UIã‹ã‚‰ã®å‡ºåŠ›ã‚’æ‹…å½“ã™ã‚‹
- å¾Œè¿°ã™ã‚‹ViewModelã«å«ã¾ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°æ©Ÿæ§‹ã®ã‚ˆã†ãªã‚‚ã®ã‚’é€šã˜ã¦è‡ªå‹•çš„ã«æç”»ã™ã‚‹ã ã‘ã§è‡ªèº«ã®å½¹å‰²ã‚’æœãŸã™
- Viewãã®ã‚‚ã®ã«è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ã¨çŠ¶æ…‹ã‚’æŒãŸãªã„ã®ãŒMVVMã®Viewã®ç‰¹å¾´

---

### MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã¯

#### ViewModel

- Viewã‚’æç”»ã™ã‚‹ãŸã‚ã®çŠ¶æ…‹ã®ä¿æŒã¨ã€Viewã‹ã‚‰å—ã‘å–ã£ãŸå…¥åŠ›ã‚’é©åˆ‡ãªå½¢ã«å¤‰æ›ã—ã¦Modelã«ä¼é”ã™ã‚‹å½¹ç›®ã‚’æŒã¤
- ã™ãªã‚ã¡Viewã¨Modelã®é–“ã®æƒ…å ±ã®ä¼é”ã¨ã€Viewã®ãŸã‚ã®çŠ¶æ…‹ä¿æŒã®ã¿ã‚’å½¹å‰²ã¨ã™ã‚‹è¦ç´ ã§ã‚ã‚‹
  - e.g. ãƒ‰ãƒ­ãƒ¯ãƒ¼ã®é–‹é–‰ãªã©

---

### MVVMã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã¯

#### ViewModel

- Viewã¨ã®é€šä¿¡ã¯ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°æ©Ÿæ§‹ã®ã‚ˆã†ãªä»•çµ„ã¿ã‚’é€šã˜ã¦è¡Œã†ãŸã‚ã€ViewModelã®å¤‰æ›´ã¯é–‹ç™ºè€…ã‹ã‚‰è¦‹ã¦è‡ªå‹•çš„ã«Viewã«åæ˜ ã•ã‚Œã‚‹

---

## `DataBinding` / `ViewBinding` ã®èª¬æ˜

---

## `DataBinding` / `ViewBinding` ã®èª¬æ˜

- ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã¯ã€ãƒ‡ãƒ¼ã‚¿ã¨å¯¾è±¡ã‚’çµã³ã¤ã‘ã€ãƒ‡ãƒ¼ã‚¿ã‚ã‚‹ã„ã¯å¯¾è±¡ã®å¤‰æ›´ã‚’æš—ç¤ºçš„ã«ã‚‚ã†ä¸€æ–¹ã®å¤‰æ›´ã¸åæ˜ ã™ã‚‹ã“ã¨ã€ãã‚Œã‚’å®Ÿç¾ã™ã‚‹ä»•çµ„ã¿ã®ã“ã¨

---

## `DataBinding` / `ViewBinding` ã®èª¬æ˜

- ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã«ã¯å¤‰æ›´åæ˜ ã®æ–¹å‘æ€§ã«ã‚ˆã£ã¦ä»¥ä¸‹ã®2ç¨®é¡ãŒå­˜åœ¨ã™ã‚‹
  - æ–¹å‘ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°(1way): data â‡’ target ã‚ã‚‹ã„ã¯ target â‡’ data ã®ã¿ã®ä¸€æ–¹å‘ãªæš—ç¤ºçš„åæ˜ 
  - åŒæ–¹å‘ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°(2way): data â‡” target ã®åŒæ–¹å‘ãªæš—ç¤ºçš„åæ˜ 

---

### â€»ã“ã“ã¾ã§Wikipediaèª¿ã¹ğŸ¤

---

### MVVMãƒ‘ã‚¿ãƒ¼ãƒ³å›³è§£

![MVVMãƒ‘ã‚¿ãƒ¼ãƒ³å›³è§£](./img/0a-0.png)

---

## å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç”¨æ„

---

## å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç”¨æ„

- ã¾ãšã¯ã‚ªãƒ¢ãƒ ãƒ­ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™

![create-project](./img/1-0.png)

---

## å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç”¨æ„

- ã¾ãšã¯ã‚ªãƒ¢ãƒ ãƒ­ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™

![create-project](./img/1-1.png)

---

## å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç”¨æ„

- ã¾ãšã¯ã‚ªãƒ¢ãƒ ãƒ­ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™

![create-project](./img/1-2.png)

---

## å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç”¨æ„

- ã“ã“ã¾ã§ã²ã¨ã¾ãšã§ãã‚Œã°OK

![create-project](./img/1-3.png)

---

## å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç”¨æ„

- ã“ã‚Œã‚‚ã‚„ã£ã¦ãŠã„ã¦ãã ã•ã„(ãã®1)ã€‚ã€‚

![create-project](./img/1-4.png)

---

### ã“ã‚Œã‚‚ã‚„ã£ã¦ãŠã„ã¦ãã ã•ã„(ãã®1)

- build.gradle(Project)ã«å¯¾ã—ã¦
  - dependenciesã«ä»¥ä¸‹ã‚’è¿½åŠ 

```gradle
// @Serializableã‚’æœ‰åŠ¹
classpath "org.jetbrains.kotlin:kotlin-serialization:$kotlin_version"
```

---

## å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç”¨æ„

- ã“ã‚Œã‚‚ã‚„ã£ã¦ãŠã„ã¦ãã ã•ã„(ãã®2)ã€‚ã€‚

![create-project](./img/1-5.png)

---

### ã“ã‚Œã‚‚ã‚„ã£ã¦ãŠã„ã¦ãã ã•ã„(ãã®2)

- build.gradle(App)ã«å¯¾ã—ã¦
  - ä¸€ç•ªä¸Šã«ä»¥ä¸‹ã‚’è¿½åŠ 

```gradle
apply plugin: 'com.android.application'
apply plugin: 'kotlin-android'
apply plugin: 'kotlin-android-extensions'
apply plugin: 'kotlin-kapt'
```

---

### ã“ã‚Œã‚‚ã‚„ã£ã¦ãŠã„ã¦ãã ã•ã„(ãã®2)

- build.gradle(App)ã«å¯¾ã—ã¦
  - android ã«ä»¥ä¸‹ã‚’è¿½åŠ 

```gradle
// ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°/ãƒ“ãƒ¥ãƒ¼ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã®æœ‰åŠ¹åŒ–
dataBinding {
  enabled = true
}
viewBinding {
  enabled = true
}
// ä½¿ç”¨ã™ã‚‹JDKã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’1.8ã«ã‚ã’ã‚‹
combileOptions {
  sourceCompatibility "1.8"
  targetCompatibility "1.8"
}
kotlinOptions {
  jvmTarget = "1.8"
}

```

---

### ã“ã‚Œã‚‚ã‚„ã£ã¦ãŠã„ã¦ãã ã•ã„(ãã®2)

- build.gradle(App)ã«å¯¾ã—ã¦
  - dependencies ã«ä»¥ä¸‹ã‚’è¿½åŠ 

```gradle
implementation fileTree(dir: "libs", include: ["*.jar"])
implementation "org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"
implementation 'androidx.core:core-ktx:1.3.1'
implementation 'androidx.appcompat:appcompat:1.2.0'
implementation 'androidx.constraintlayout:constraintlayout:2.0.1'
implementation 'androidx.lifecycle:lifecycle-extensions:2.2.0'
implementation 'androidx.lifecycle:lifecycle-viewmodel-ktx:2.2.0'
implementation 'androidx.legacy:legacy-support-v4:1.0.0'
implementation "androidx.fragment:fragment-ktx:1.2.5"
testImplementation 'junit:junit:4.12'
androidTestImplementation 'androidx.test.ext:junit:1.1.2'
androidTestImplementation 'androidx.test.espresso:espresso-core:3.3.0'
implementation "org.jetbrains.kotlinx:kotlinx-serialization-runtime:0.10.0"

implementation "org.jetbrains.kotlin:kotlin-reflect:$kotlin_version"

//layout
implementation 'androidx.appcompat:appcompat:1.2.0'
implementation 'com.google.android.material:material:1.2.1'
implementation 'androidx.constraintlayout:constraintlayout:2.0.1'
implementation 'androidx.cardview:cardview:1.0.0'
implementation 'androidx.recyclerview:recyclerview:1.1.0'

// retrofit
implementation 'com.squareup.retrofit2:retrofit:2.6.0'

// moshi
def moshi_version = "1.5.0"
implementation "com.squareup.moshi:moshi:$moshi_version"
implementation "com.squareup.moshi:moshi-kotlin:$moshi_version"
implementation "com.squareup.retrofit2:converter-moshi:2.4.0"

// Android Architecture Components
implementation 'androidx.lifecycle:lifecycle-extensions:2.2.0'
implementation 'androidx.lifecycle:lifecycle-runtime:2.2.0'
annotationProcessor 'androidx.lifecycle:lifecycle-common-java8:2.2.0'

//viewmodel-ktx viewModelScopeã‚’ä½¿ã†ãŸã‚
implementation "androidx.lifecycle:lifecycle-viewmodel-ktx:2.2.0"

// OkHttp
implementation "com.squareup.okhttp3:okhttp:3.12.11"
implementation "com.squareup.okhttp3:logging-interceptor:3.12.1"
implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version"

//Kotlin Coroutines
implementation "org.jetbrains.kotlinx:kotlinx-coroutines-core:1.3.7"
implementation "org.jetbrains.kotlinx:kotlinx-coroutines-android:1.3.7"

// glide
implementation 'com.github.bumptech.glide:glide:4.9.0'
annotationProcessor 'com.github.bumptech.glide:compiler:4.9.0'

kapt "com.android.databinding:compiler:3.1.4"
```

---

### ã“ã‚Œã‚‚ã‚„ã£ã¦ãŠã„ã¦ãã ã•ã„(ãã®2)

#### æ­£ç›´ã„ã¡ã„ã¡æ‰‹å…¥åŠ›ã™ã‚‹ã®ã‚ã‚“ã©ã„ã®ã§é…å¸ƒã—ã¾ã™

- ãªã‚“ãªã‚‰ã‚¹ãƒ©ã‚¤ãƒ‰å†…ã«åã¾ã£ã¦ã„ãªã„
- ã‚³ãƒ”ãƒšã—ã¦ãã ã•ã„

---

### ã“ã‚Œã‚‚ã‚„ã£ã¦ãŠã„ã¦ãã ã•ã„(ãã®3)

- AndroidManifest.xmlã«
  - `</application>`ã®ä¸‹ã‚ãŸã‚Šã«ä»¥ä¸‹ã‚’è¿½åŠ 

```xml
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
```

---

### Gradle Syncing Time

![Sync Gradle](./img/1-6.png)
![Whale Watching Time](./img/1-7.png)

---

### Kotlin (+DataBinding) ãƒ‡ãƒãƒƒã‚°ã®å¿ƒå¾—

- (ã‚ˆãã‚ã‹ã‚‰ãªã„ã‚¨ãƒ©ãƒ¼ãŒå¤šã„ã‘ã©)æŠ˜ã‚Œãªã„
- (ã‚ˆãã‚ã‹ã‚‰ãªã„ã‚¨ãƒ©ãƒ¼ãŒå¤šã„ã‘ã©)é€ƒã’ãªã„
- ã‚ˆãã‚ã‹ã‚‰ãªã„ã‚¨ãƒ©ãƒ¼(`HogeFugaBindingImpl` ã®ã‚·ãƒ³ãƒœãƒ«ãŒè§£æ±ºã§ãã¾ã›ã‚“) ãŒå‡ºãŸã‚‰ã€ã¾ãšView(xml)ã®å®Ÿè£…ã‚’ç–‘ãŠã†
  - è¨­å®šã—ã¦ã„ã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒç„¡ã„ã¨ã‹ã§ã‚‚å¹³æ°—ã§ `BindingImpl` ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’ãƒŸã‚¹ã‚Šã‚„ãŒã£ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã‚¨ãƒ©ãƒ¼ã‚’åãã‚„ãŒã‚‹ã€‚ã€‚ã€‚

---

## APIé€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`Repository`) ã®ä½œæˆ

---

### Repository #ã¨ã¯

---

### Repository #ã¨ã¯

- ViewModelã‹ã‚‰å®Ÿè¡Œã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã®å–å¾—éƒ¨åˆ†

![MVVMãƒ‘ã‚¿ãƒ¼ãƒ³å›³è§£](./img/0a-0.png)

---

## APIé€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`Repository`) ã®ä½œæˆ

- ã¾ãšPackageã‚’ä½œã‚‹

![Packageä½œæˆ](./img/2-0.png)

---

## APIé€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`Repository`) ã®ä½œæˆ

- ã¾ãšPackageã‚’ä½œã‚‹

![Packageä½œæˆ](./img/2-1.png)
![Packageä½œæˆ](./img/2-2.png)

---

## APIé€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`Repository`) ã®ä½œæˆ

- RecruitAPIã‚’å…ƒã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”¨ã®ãƒ¢ãƒ‡ãƒ«ã‚’ç”¨æ„ã™ã‚‹
  - https://webservice.recruit.co.jp/doc/carsensor/reference.html#a1to

---

## APIé€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`Repository`) ã®ä½œæˆ

- RecruitAPIã‚’å…ƒã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”¨ã®ãƒ¢ãƒ‡ãƒ«ã‚’ç”¨æ„ã™ã‚‹
  - ã“ã‚Œã‚„ã£ã¦ã‚‹ã ã‘ã§2æ™‚é–“ä½™è£•ã§~~æ½°ã—ãŸ~~æ½°ã‚Œã‚‹ã®ã§ã€é…å¸ƒã—ã¾ã™
  - `models` ä»¥ä¸‹ã«é…ç½®ã—ã¦ãã ã•ã„
  - `package` ã‚ãŸã‚Šã¯é©å®œå¤‰æ›´ã—ã¦ãŠã„ã¦ãã ã•ã„

---

### `data class` #ã¨ã¯

- ã‚¯ãƒ©ã‚¹å®šç¾©ã®æ–¹æ³•ã®ã²ã¨ã¤
- `data class` ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ä»¥ä¸‹ãŒè‡ªå‹•çš„ã«å®šç¾©ã•ã‚Œã‚‹
  - `equals()` / `hashCode()` ã®ãƒšã‚¢ï¼šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ¯”è¼ƒã®éš›ã«ä½¿ç”¨
  - ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚‚å«ã‚“ã å½¢å¼ã® `toString()` ãƒ¡ã‚½ãƒƒãƒ‰ï¼šæ¬¡ç¯€ã§ä¾‹ç¤º
  - `componentN()` ãƒ¡ã‚½ãƒƒãƒ‰ï¼šå®£è¨€ã—ãŸé †ç•ªã§ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å–ã‚Šå‡ºã™ã“ã¨ãŒã§ãã‚‹ãƒ¡ã‚½ãƒƒãƒ‰
  - `copy()` ãƒ¡ã‚½ãƒƒãƒ‰ï¼šå®Œå…¨ã«åˆ¥ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã—ã¦ã€ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨å…¨ãåŒã˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰


---

## APIé€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`Repository`) ã®ä½œæˆ

- å®šæ•°ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã™ã‚‹

![å®šæ•°ã‚¯ãƒ©ã‚¹ä½œæˆ](./img/2-1a.png)
![å®šæ•°ã‚¯ãƒ©ã‚¹ä½œæˆ](./img/2-1b.png)

---

## APIé€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`Repository`) ã®ä½œæˆ

- å®šæ•°ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã™ã‚‹
  - API_KEYã®éƒ¨åˆ†ã¯é©å®œç”Ÿæˆã—ãŸã‚­ãƒ¼ã‚’å…¥ã‚Œã¦ãã ã•ã„

```kotlin
package com.example.mycarsensorapp

class Constant {
    companion object {
        // APIé€šä¿¡ã®ãƒ™ãƒ¼ã‚¹URL
        const val BASE_URL = "https://webservice.recruit.co.jp/carsensor/"
        // APIã‚¢ã‚¯ã‚»ã‚¹ç”¨ã‚­ãƒ¼
        const val API_KEY = ""
        // ã‚«ãƒ¼ã‚»ãƒ³ã‚µãƒ¼APIã®URL
        const val CARSENSOR_URL = "http://webservice.recruit.co.jp/"
    }
}
```

---

### `companion object` #ã¨ã¯

- `object` ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¨åŒã˜ãã€Singletonã‚’ä½œæˆã™ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
- `object` ã¨ç•°ãªã‚Šã€ã‚¯ãƒ©ã‚¹ã«å±ã—ã¾ã™

#### â€»Kotlinã« `static` ã¯å­˜åœ¨ã—ãªã„ã®ã§ã€ `static` ã‚’ä½¿ç”¨ã—ãŸã„å ´åˆã¯ `object` ã¾ãŸã¯ `companion object` ã‚’ä½¿ç”¨ã—ã¾ã™

---

## APIé€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`Repository`) ã®ä½œæˆ

- é€šä¿¡ç”¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ä½œã‚‹

![é€šä¿¡ç”¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ä½œæˆ](./img/2-3.png)

---

## APIé€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`Repository`) ã®ä½œæˆ

- é€šä¿¡ç”¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ä½œã‚‹

![é€šä¿¡ç”¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ä½œæˆ](./img/2-4.png)

---

## APIé€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`Repository`) ã®ä½œæˆ

- é€šä¿¡ç”¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ä½œã‚‹
  -  è©¦ã—ã«ãƒ–ãƒ©ãƒ³ãƒ‰ã®ä¸€è¦§ã‚’å–å¾—ã™ã‚‹ã‚‚ã®ã‚’å®Ÿè£…ã—ã¦ã¿ã¾ã—ã‚‡ã†
  
```kotlin
interface APIService {
    // APIã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®æŒ‡å®š
    @GET("brand/v1/")
    // å¼•æ•°ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ã¯ Call<T>ã‚’æŒ‡å®šã™ã‚‹ã“ã¨
    // (Tã¯ä»»æ„ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ)
    fun getBrandMaster(
        @Query("key") key: String = Constant.API_KEY,
        @Query("format") format: String = "json"
    ): Call<BrandMasterRootResponseModel>
}
```

---

## APIé€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`Repository`) ã®ä½œæˆ

- é€šä¿¡ç”¨ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ©ã‚¹ã‚’ä½œã‚‹

![é€šä¿¡ç”¨ãƒªãƒã‚¸ãƒˆãƒªä½œæˆ](./img/2-5.png)
![é€šä¿¡ç”¨ãƒªãƒã‚¸ãƒˆãƒªä½œæˆ](./img/2-6.png)

---

## APIé€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`Repository`) ã®ä½œæˆ

- é€šä¿¡ç”¨ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ©ã‚¹ã‚’ä½œã‚‹

```kotlin
class Repository {
    private val retrofit = Retrofit.Builder()
        .baseUrl(Constant.BASE_URL)
        .addConverterFactory(MoshiConverterFactory.create())
        .build()

    private val service = retrofit.create(ICarsensorAPIService::class.java)
    // å®Ÿéš›ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã†ãƒ¡ã‚½ãƒƒãƒ‰
    // æˆ»ã‚Šå€¤ã¯å…ˆã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«åˆã‚ã›ã¦å¿…ãš Call<T>
    // (Tã¯ä»»æ„ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚ŒãŸã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ)
    suspend fun getBrands(): Call<BrandMasterRootResponseModel> = service.getBrandMaster()

    // ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ
    companion object Factory {
        val instance: Repository
            @Synchronized get() {
                return Repository()
            }
    }
}
```

---

### Retrofit2 #ã¨ã¯

- OkHttp3ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒ©ãƒƒãƒ‘ãƒ¼
- ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’æ›¸ãã‚„ã™ãã—ã¦ãã‚Œã¾ã™
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å†…å®¹ã‹ã‚‰å®Ÿéš›ã®POJOã«å¯¾ã—ã¦ORãƒãƒƒãƒ”ãƒ³ã‚°ã—ã¦ãã‚ŒãŸã‚Šã‚‚ã—ã¦ãã‚Œã¾ã™

---

### `suspend fun` #ã¨ã¯

- Kotlinã®éåŒæœŸå‡¦ç†ã®ã²ã¨ã¤
- ã“ã®é–¢æ•°å®šç¾©å†…ã®å‡¦ç†ã¯ä¸­æ–­ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹
- ã“ã®é–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹éš›ã€å‘¼ã³å…ƒã¯ `Scope.launch { ... }` å†…(åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰)ã‹ã‚‰å‘¼ã¶
  - åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰ã§å‘¼ã¶ã“ã¨ãŒã§ãã‚‹ -> éåŒæœŸå‡¦ç†ã¨ãªã‚‹

---

## APIé€šä¿¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`Repository`) ã®ä½œæˆ

- ä½œã£ãŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’è©¦ã—ã¦ã¿ãŸã„ã€‚ã€‚ã€‚ï¼
  - ã§ã¯å®Ÿéš›ã«æç”»ã™ã‚‹ç®‡æ‰€ã‚’ä½œæˆã—ã¦ã„ãã¾ã—ã‚‡ã†

---

## æœ€åˆã® View/ViewModel (`MainFragment` / `MainViewModel`) ã®ä½œæˆ

---

## æœ€åˆã® View/ViewModel ã®ä½œæˆ

### ä»¥ä¸‹ã®æ‰‹é †ã§å®Ÿè£…ã—ã¦ã„ãã¾ã™

- Viewã®ä½œæˆ
- ViewModelã®ä½œæˆ
- Spinnerã®ä½œæˆ
- æ¤œç´¢ãƒœã‚¿ãƒ³ã®å®Ÿè£…
- æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

---


## View/ViewModel ã®ä½œæˆ

### Viewã®ä½œæˆ

- ã¾ãšã€Viewã‚’ä½œæˆã—ã¾ã™
- ä»¥ä¸‹ã®4ã¤ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚Œã°ã„ã„ã§ã™
  - æ¤œç´¢ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥ã‚Œã‚‹ `EditText`
  - ãƒ–ãƒ©ãƒ³ãƒ‰ã‚’é¸æŠã™ã‚‹ `Spinner`
  - æ¤œç´¢ãƒœã‚¿ãƒ³ã® `Button`
  - æ¤œç´¢çµæœã‚’è¡¨ç¤ºã•ã›ã‚‹ `RecyclerView`

---

## View/ViewModel ã®ä½œæˆ

### Viewã®ä½œæˆ

![MainView](./img/3-0.png)

---

## View/ViewModel ã®ä½œæˆ

###  ViewModelã®ä½œæˆ

- ViewModelã§ã¯å®Ÿéš›ã®é€šä¿¡å‡¦ç†ã®å®Ÿè¡Œã¨ã€ãã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ä¿æŒã‚’è¡Œã„ã¾ã™

---

## View/ViewModel ã®ä½œæˆ

### ViewModelã®ä½œæˆ

- ViewModelã¯ `AndroidViewModel` ã‚’ç¶™æ‰¿ã•ã›ã¾ã—ã‚‡ã†
- ã“ã®æ™‚ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿å¼•æ•°ã®åå‰ã‚’ `aplication` ã«ã™ã‚‹ã¨ã€ **æ—¢å­˜ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®åå‰ã¨ç«¶åˆã—ã¦è¬ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã‚’å¼•ãèµ·ã“ã—ã¾ã™ã®ã§æ³¨æ„**

```kotlin
class MainViewModel(
    private val myApplication: Application
): AndroidViewModel(myApplication) {
```

---

## View/ViewModel ã®ä½œæˆ

### ViewModelã®ä½œæˆ

- ã¾ãšã€å®Ÿéš›ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–ã£ã¦ãã‚‹å‡¦ç†ã‚’è¨˜è¿°ã—ã¾ã™
  
```kotlin
class MainViewModel(
    private val myApplication: Application
): AndroidViewModel(myApplication) {
    private val _repository = Repository.instance
    var brandsLiveData: MutableLiveData<List<BrandModel>> =
      MutableLiveData()

    init {
        loadLiveData()
    }

    // loadLiveData()
}
```

---

## View/ViewModel ã®ä½œæˆ

### ViewModelã®ä½œæˆ

- ã¾ãšã€å®Ÿéš›ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–ã£ã¦ãã‚‹å‡¦ç†ã‚’è¨˜è¿°ã—ã¾ã™

```kotlin
    // loadLiveData()
    private fun loadLiveData() {
        viewModelScope.launch(Dispatchers.IO) {
            try {
                val brandsRequest = _repository.getBrands()
                val brandsResponse = brandsRequest.execute()
                if (brandsResponse.isSuccessful) {
                    val mutableBrands = brandsResponse.body()?.results?.brand?.toMutableList()
                    mutableBrands?.add(0, BrandModel("", "< æœªé¸æŠ >", CodeNamePair("", "")))
                    brandsLiveData.postValue(mutableBrands)
                }
            } catch (ex: Exception) {
                ex.printStackTrace()
            }
        }
    }
```

---

## View/ViewModel ã®ä½œæˆ

### ViewModelã®ä½œæˆ

#### `MutableLiveData<T>`

- å®Ÿéš›ã®Viewã«æ¸¡ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹å¤‰æ•°ã«ä½¿ç”¨ã™ã‚‹å‹

---

## View/ViewModel ã®ä½œæˆ

### ViewModelã®ä½œæˆ

#### `viewModelScope.launch(Dispatchers.IO) { ... }`

- å…ˆã»ã©èª¬æ˜ã—ãŸã€ `suspend` é–¢æ•°ã‚’ã‚³ãƒ¼ãƒ«ã™ã‚‹ãŸã‚ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã¿ãŸã„ãªã‚‚ã®ã§ã™
- `Dispatchers.IO` ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰(æç”»ã‚¹ãƒ¬ãƒƒãƒ‰)ä»¥å¤–ã®IOã‚¹ãƒ¬ãƒƒãƒ‰ã§å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™

---

## View/ViewModel ã®ä½œæˆ

### Viewã®ä½œæˆ

#### Spinnerç”¨ã®Adapterã®ä½œæˆ

```kotlin
class BrandArrayAdapter(
    context: Context,
    resource: Int,
    models: List<BrandModel>
) : ArrayAdapter<BrandModel>(context, resource, models) {

    override fun getView(position: Int, convertView: View?, parent: ViewGroup): View {
        val textView = super.getView(position, convertView, parent) as TextView
        textView.text = getItem(position)?.name

        return textView
    }

    override fun getDropDownView(position: Int, convertView: View?, parent: ViewGroup): View {
        val textView = super.getDropDownView(position, convertView, parent) as TextView
        textView.text = getItem(position)?.name

        return textView
    }
}
```

---

## View/ViewModel ã®ä½œæˆ

### Viewã®ä½œæˆ

```kotlin
override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
    super.onViewCreated(view, savedInstanceState)
    viewModel.brandsLiveData.observe(viewLifecycleOwner, Observer { brands ->
        // ãƒ‡ãƒ¼ã‚¿ãŒæ›´æ–°ã•ã‚ŒãŸã‚‰ã€è‡ªå‹•çš„ã«ã“ã®ä¸­ã«å…¥ã£ã¦ãã‚‹
        // brands ãŒå–å¾—ã—ã¦ããŸãƒ‡ãƒ¼ã‚¿
        brands?.let {
            // Spinnerã®Adapterã«å–ã£ã¦ããŸãƒ‡ãƒ¼ã‚¿ã¨åˆã‚ã›ã¦Adapterã‚’ã‚»ãƒƒãƒˆ
            main__spinner_brand.adapter = context?.let { it1 ->
                BrandArrayAdapter(it1, android.R.layout.simple_spinner_item, brands)
            }
        }
    })
}
```

---

## View/ViewModel ã®ä½œæˆ

- ã“ã‚“ãªæ„Ÿã˜ã«ã‚¢ãƒ—ãƒªãŒå®Ÿè¡Œã§ãã‚Œã°OKã§ã™

![ã‚¢ãƒ—ãƒªå®Ÿè¡Œãƒ†ã‚¹ãƒˆ](./img/3-1.png)

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢ãƒœã‚¿ãƒ³ã®å®Ÿè£…

- ã¾ãšRepositoryã«ä¸­å¤è»Šæ¤œç´¢ã‚’è¿½åŠ 
  - ã®ã§Interfaceã«æ–°ã—ã„é–¢æ•°ã‚’è¿½åŠ ã™ã‚‹

```kotlin
interface APIService {
    @GET("usedcar/v1/")
    fun getCars(
        @Query("key") key: String = Constant.API_KEY,
        @Query("brand") brand: String,
        @Query("format") format: String = "json"
    ): Call<SearchCarRootResponseModel>
    // :
    // :
}
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢ãƒœã‚¿ãƒ³ã®å®Ÿè£…

- ã¾ãšRepositoryã«ä¸­å¤è»Šæ¤œç´¢ã‚’è¿½åŠ 

```kotlin
class Repository {
    // :
    // :
    suspend fun getCars(
        key: String,
        brand: String,
    ): Call<SearchCarRootResponseModel> = service.getCars(key, brand, "json")
    // :
    // :
}
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢ãƒœã‚¿ãƒ³ã®å®Ÿè£…

- ViewModelã§å®Ÿéš›ã«æ¤œç´¢APIã‚’å©ãé–¢æ•°ã‚’å®Ÿè£…ã™ã‚‹

```kotlin
class MainViewModel(
    private val myApplication: Application
): AndroidViewModel(myApplication) {
    // :
    // :
    fun fetchUsedCarLiveData(name: String, brandCode: String) {
        viewModelScope.launch(Dispatchers.IO) {
            try {
                val request = _repository.getCars( Constant.API_KEY, brandCode)
                val response = request.execute()
                if (response.isSuccessful) {
                    carsLiveData.postValue(response.body()?.results?.usedcar)
                }
            } catch (ex: java.lang.Exception) {
                ex.printStackTrace()
            }
        }
    }
    // :
    // :
}
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢ãƒœã‚¿ãƒ³ã®å®Ÿè£…

- å®Ÿéš›ã«å©ãListenerã‚’ä½œã‚‹

```kotlin
class MainFragment : Fragment() {
    // :
    // :
    private val onSearchButtonClickListener = View.OnClickListener {
        viewModel.fetchUsedCarLiveData(
            main__edittext_used_car_name.text.toString(),
            (main__spinner_brand.selectedItem as BrandModel).code)
    }
    // :
    // :
}
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢ãƒœã‚¿ãƒ³ã®å®Ÿè£…

- æ¤œç´¢ãƒœã‚¿ãƒ³ãŒå©ã‹ã‚ŒãŸå¾Œã€å®Ÿéš›ã«ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚‹å ´æ‰€ã‚’ãƒ¢ãƒƒã‚¯å®Ÿè£…ã§ã¤ãã‚‹

```kotlin
override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
    super.onViewCreated(view, savedInstanceState)
    viewModel.carsLiveData.observe(viewLifecycleOwner, Observer { cars ->
        cars?.let {
            var message = ""
            for (car in cars) {
                message += car.brand.name + ": " + car.model.toString() + "Â¥n"
            }
            AlertDialog.Builder(context)
                .setTitle("æ¤œç´¢çµæœ")
                .setMessage(message)
                .setPositiveButton("OK"){ dialog, which -> }
                .show()
        }
    })
}
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢ãƒœã‚¿ãƒ³ã®å®Ÿè£…

- Bindingã«ç¹‹ãè¾¼ã‚€

```kotlin
private lateinit var binding: MainFragmentBinding

override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?,
                          savedInstanceState: Bundle?): View {
    binding = MainFragmentBinding.inflate(inflater, container, false)
    binding.apply {
        onClickSerarch = onSearchButtonClickListener
    }
    return binding.root
}
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢ãƒœã‚¿ãƒ³ã®å®Ÿè£…

- å®Ÿéš›ã«å©ã‘ã‚‹ã‚ˆã†ã«ç¹‹ãè¾¼ã‚€

```xml
<data>
    <import type="android.view.View"/>
    <variable name="isOpen" type="boolean" />
    <variable name="isLoading" type="boolean" />
    <variable name="onClickSearch" type="android.view.View.OnClickListener" />

</data>
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢ãƒœã‚¿ãƒ³ã®å®Ÿè£…

- å®Ÿéš›ã«å©ã‘ã‚‹ã‚ˆã†ã«ç¹‹ãè¾¼ã‚€

```xml
<!-- ä¸Šã§æŒ‡å®šã—ãŸonClickSearchã‚’ã“ã£ã¡ã§ã‚‚æŒ‡å®šã™ã‚‹ -->
<Button
    android:id="@+id/main__button_search"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_margin="10dp"
    android:layout_gravity="center"
    android:text="@string/search"
    android:onClick="@{onClickSearch}"
    />
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢ãƒœã‚¿ãƒ³ã®å®Ÿè£…

- å®Ÿè¡Œã™ã‚‹ã¨ã“ã†ãªã‚Šã¾ã™

![å®Ÿè¡Œçµæœ](./img/3-3.png)

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

- RecylerViewã«è¡¨ç¤ºã™ã‚‹Adapterã‚’ä½œæˆã—ã¾ã™
  - ã¾ãšã¯View(xml)ã‹ã‚‰

![RecylerViewã®ãªã‹ã¿](./img/3-2.png)

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

- xmlã®ä¸­èº«ã¯ã“ã®ã‚ˆã†ã«å®šç¾©ã—ã¦ãŠãã¾ã™
  - `<data>` å®šç¾©ãŒãƒã‚¤ãƒ³ãƒˆ

```xml
<layout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    >

    <data>
        <variable name="usedCar" type="com.example.mycarsensorapp.models.UsedCarModel" />
        <variable name="callback" type="com.example.mycarsensorapp.ui.callbacks.UsedCarClickCallback" />
    </data>
    <!-- : -->
    <!-- : -->
</layout>
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

- xmlã®ä¸­èº«ã¯ã“ã®ã‚ˆã†ã«å®šç¾©ã—ã¦ãŠãã¾ã™
  - onClickã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‘¼ã³å‡ºã—ã‚„
  - `app:imageUrl` ã®ã‚ˆã†ãªã¨ã“ã‚ã§ç›´æ¥ãƒ¢ãƒ‡ãƒ«ã®ä¸­èº«ã‚’å‚ç…§ã•ã›ã¦ã„ã‚‹ã®ãŒãƒã‚¤ãƒ³ãƒˆ

```xml
    <!-- : -->
    <!-- : -->
        <androidx.cardview.widget.CardView
        android:layout_width="match_parent"
        android:layout_height="100dp"
        android:orientation="horizontal"
        android:onClick="@{() ->  callback.onClick(usedCar)}"
        android:layout_margin="10dp"
        app:cardUseCompatPadding="true">
        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:onClick="@{() -> callback.onClick(usedCar)}"
            >
            <ImageView
                android:id="@+id/used_car_list_item__imageview_thumbnail"
                android:layout_width="150dp"
                android:layout_height="match_parent"
                android:layout_margin="5dp"
                app:imageUrl="@{usedCar.photo.main.l}"
                />
    <!-- : -->
    <!-- : -->
</layout>
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

- ClickCallback(Listener)
  - ã“ã‚“ãªæ„Ÿã˜ã§æ–°ãŸã«ä½œæˆã—ã¾ã™
  - ã“ã‚Œã§ä¸Šã§å®šç¾©ã—ãŸxmlã®ã‚¨ãƒ©ãƒ¼ã®ã²ã¨ã¤ã¯è§£æ¶ˆã•ã‚Œã¦ã„ã‚‹ã¯ãšã§ã™ã€‚ã€‚ã€‚

```kotlin
package com.example.mycarsensorapp.ui.callbacks

import com.example.mycarsensorapp.models.UsedCarModel

interface UsedCarClickCallback {
    fun onClick(usedCarModel: UsedCarModel)
}
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

- Adapter
  - æ›¸ãåˆ†é‡å¤šã™ãã‚‹ã®ã§ã“ã¡ã‚‰ã¯é…å¸ƒã—ã¾ã™

```kotlin
class UsedCarAdapter(
    private val usedCarClickCallback: UsedCarClickCallback
) : RecyclerView.Adapter<UsedCarAdapter.UsedCarViewHolder>() {

    private var _usedCars: List<UsedCarModel>? = null

    fun setUsedCars(usedCars: List<UsedCarModel>) {

        if (this._usedCars == null) {
            this._usedCars = usedCars

            notifyItemRangeInserted(0, usedCars.size)

        } else {

            val result = DiffUtil.calculateDiff(object : DiffUtil.Callback() {
                override fun getOldListSize(): Int {
                    return requireNotNull(this@UsedCarAdapter._usedCars).size
                }

                override fun getNewListSize(): Int {
                    return usedCars.size
                }

                override fun areItemsTheSame(oldItemPosition: Int, newItemPosition: Int): Boolean {
                    val oldList = this@UsedCarAdapter._usedCars
                    return oldList?.get(oldItemPosition)?.model == usedCars[newItemPosition].model
                }

                override fun areContentsTheSame(oldItemPosition: Int, newItemPosition: Int): Boolean {
                    val old = this@UsedCarAdapter._usedCars!![oldItemPosition]
                    val new = this@UsedCarAdapter._usedCars!![newItemPosition]
                    return old.model?.contentEquals(new.model)
                }
            })
            this._usedCars = usedCars

            result.dispatchUpdatesTo(this)
        }
    }

    override fun onCreateViewHolder(parent: ViewGroup, viewtype: Int): UsedCarViewHolder {
        val binding =
            DataBindingUtil.inflate(
                LayoutInflater.from(parent.context),
                R.layout.used_car_list_item,
                parent,
                false
            ) as UsedCarListItemBinding

        binding.callback = usedCarClickCallback

        return UsedCarViewHolder(binding)
    }

    override fun onBindViewHolder(holder: UsedCarViewHolder, position: Int) {
        holder.binding.usedCar = _usedCars?.get(position)
        holder.binding.executePendingBindings()
    }

    override fun getItemCount(): Int {
        return _usedCars?.size ?: 0
    }

    open class UsedCarViewHolder(val binding: UsedCarListItemBinding) : RecyclerView.ViewHolder(binding.root)
}
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

#### UsedCarAdapterã®è§£èª¬

- åˆå›ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ä½œæˆæ™‚ã¯ãã®ã¾ã¾ä»£å…¥ã—ã¾ã™
- `notifyItemRangeInserted(...)` ã§ã‚¢ã‚¤ãƒ†ãƒ ãŒè¿½åŠ ã•ã‚ŒãŸã“ã¨ã‚’é€šçŸ¥ã—ã¾ã™

```kotlin
if (this._usedCars == null) {
    this._usedCars = usedCars

    notifyItemRangeInserted(0, usedCars.size)
    // :
    // :
}
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

#### UsedCarAdapterã®è§£èª¬

- `getOldListSize`
  - ç¾åœ¨ã®ãƒªã‚¹ãƒˆã‚µã‚¤ã‚ºã‚’è¿”å´ã•ã›ã¾ã™
- `getNewListSize`
  - æ–°ã—ã„ãƒªã‚¹ãƒˆã‚µã‚¤ã‚ºã‚’è¿”å´ã•ã›ã¾ã™

```kotlin
val result = DiffUtil.calculateDiff(object : DiffUtil.Callback() {
    override fun getOldListSize(): Int {
        return requireNotNull(this@UsedCarAdapter._usedCars).size
    }

    override fun getNewListSize(): Int {
        return usedCars.size
    }
    // :
    // :
})
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

#### UsedCarAdapterã®è§£èª¬

- `areItemTheSame`
  - ç¾åœ¨ã®ãƒªã‚¹ãƒˆã¨æ–°ã—ã„ãƒªã‚¹ãƒˆã®å„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ(indexæŒ‡å®šæœ‰ã‚Š)ã®ãƒã‚¤ãƒ³ã‚¿ã‚’æ¯”è¼ƒã—ã¦åŒä¸€ã‹ã©ã†ã‹ã‚’è¿”ã—ã¾ã™
- `areContentsTheSame`
  - ç¾åœ¨ã®ãƒªã‚¹ãƒˆã¨æ–°ã—ã„ãƒªã‚¹ãƒˆã®å„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ(indexæŒ‡å®šæœ‰ã‚Š)ã®å®Ÿéš›ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å€¤ã‚’æ¯”è¼ƒã—ã¦åŒä¸€ã‹ã©ã†ã‹ã‚’è¿”ã—ã¾ã™

```kotlin
val result = DiffUtil.calculateDiff(object : DiffUtil.Callback() {
    // :
    // :
    override fun areItemsTheSame(oldItemPosition: Int, newItemPosition: Int): Boolean {
        val oldList = this@UsedCarAdapter._usedCars
        return oldList?.get(oldItemPosition)?.model == usedCars[newItemPosition].model
    }

    override fun areContentsTheSame(oldItemPosition: Int, newItemPosition: Int): Boolean {
        val old = this@UsedCarAdapter._usedCars!![oldItemPosition]
        val new = this@UsedCarAdapter._usedCars!![newItemPosition]
        return old.model?.contentEquals(new.model)
    }
})
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

#### UsedCarAdapterã®è§£èª¬

- `result.disaptchUpdatesTo(this)`
  - Adapterã¸ãƒªã‚¹ãƒˆã®æ›´æ–°ã‚’é€šçŸ¥ã—ã¾ã™

```kotlin
result.dispatchUpdatesTo(this)
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

#### UsedCarAdapterã®è§£èª¬

- `onCreateViewHolder(...)`
  - RecyclerViewã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ¡ã‚½ãƒƒãƒ‰ã®ã²ã¨ã¤ã§ã™
  - ã¾ãšbindingã‚’å–ã£ã¦ãã¦
  - callbacké–¢æ•°ã‚’ã‚»ãƒƒãƒˆã—ã¦ã‚„ã‚‹(å¾Œè¿°ã™ã‚‹è‡ªä½œClickListener)
  - å¾Œè¿°ã™ã‚‹ `UsedCarViewHolder` ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿”ã™ã‚ˆã†ã«ã—ã¾ã™

```kotlin
override fun onCreateViewHolder(parent: ViewGroup, viewtype: Int): UsedCarViewHolder {
    val binding =
        DataBindingUtil.inflate(
            LayoutInflater.from(parent.context),
            R.layout.used_car_list_item,
            parent,
            false
        ) as UsedCarListItemBinding

    binding.callback = usedCarClickCallback

    return UsedCarViewHolder(binding)
}
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

#### UsedCarAdapterã®è§£èª¬

- `onBindViewHolder(...)`
  - RecyclerViewã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ¡ã‚½ãƒƒãƒ‰ã®ã²ã¨ã¤ã§ã™
  - RecyclerViewã®å„ã‚¢ã‚¤ãƒ†ãƒ ã®æç”»æ›´æ–°ã‚’æ‹…ã„ã¾ã™
  - xmlå´ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å†…å®¹ã®æç”»æŒ‡å®šã‚’è¡Œã£ã¦ã„ã‚‹ã®ã§ã€ã“ã“ã§ã¯ `UsedCarModel` ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ¸¡ã™ã ã‘ã«ã—ã¾ã™
- `getItemCount()`
  - RecyclerViewã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ¡ã‚½ãƒƒãƒ‰ã®ã²ã¨ã¤ã§ã™
  - ç¾åœ¨ã®ãƒªã‚¹ãƒˆã®ã‚µã‚¤ã‚ºã‚’è¿”ã—ã¦ã‚„ã‚Œã°OK

```kotlin
override fun onBindViewHolder(holder: UsedCarViewHolder, position: Int) {
    holder.binding.usedCar = _usedCars?.get(position)
    holder.binding.executePendingBindings()
}

override fun getItemCount(): Int {
    return _usedCars?.size ?: 0
}
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

#### UsedCarAdapterã®è§£èª¬

- `open` ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€Œç¶™æ‰¿å¯èƒ½ã€ã‚’æ„å‘³ã—ã¾ã™
- ã“ã®ã‚¯ãƒ©ã‚¹ã§ã¯ `RecyclerView.ViewHolder` ã‚’ç¶™æ‰¿ã—ã¦ã„ã¾ã™ãŒ
- ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®superã«å¼•æ•°ã® `binding` ã®ãƒ¡ãƒ³ãƒ `root` ã‚’æ¸¡ã—ã¦ã„ã¾ã™
- ã“ã‚Œã§ `UsedCarAdapter` ã®æº–å‚™ã¯OK

```kotlin
open class UsedCarViewHolder(val binding: UsedCarListItemBinding) : RecyclerView.ViewHolder(binding.root)
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

#### Viewã®å®Ÿè£…

- MainFragmentã«ä»¥ä¸‹ã‚’å®Ÿè£…ã—ã¾ã™
  - RecyclerViewãŒã‚¿ãƒƒãƒ—ã•ã‚ŒãŸæ™‚ã®æŒ™å‹•ã§ã™

```kotlin
private val usedCarRecyclerViewAdapter = UsedCarAdapter(object : UsedCarClickCallback {
    override fun onClick(usedCarModel: UsedCarModel) {
        if (lifecycle.currentState.isAtLeast(Lifecycle.State.STARTED) && activity is MainActivity) {
            AlertDialog.Builder(context)
                       .setTitle("ã‚¿ãƒƒãƒ—ã—ãŸã‚‚ã®")
                       .setMessage(usedCarModel.model)
                       .setPositiveButton("OK"){ dialog, which -> }
                       .show()

        }
    }
})
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

#### Viewã®å®Ÿè£…

- MainFragmentã«ä»¥ä¸‹ã‚’å®Ÿè£…ã—ã¾ã™
  - æ—¢å­˜ã®å®Ÿè£…ã‚’å¤‰æ›´ã—ã¾ã™

```kotlin
viewModel.carsLiveData.observe(viewLifecycleOwner, Observer { cars ->
    cars?.let {
        usedCarRecyclerViewAdapter.setUsedCars(cars)
    }
})
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

#### Viewã®å®Ÿè£…

- `ImageViewExtension` ã‚’å®Ÿè£…ã—ã¾ã™
  - å¿˜ã‚Œã‚‹ã¨è¬ã®ã‚¨ãƒ©ãƒ¼ã§æ­»ã«ã¾ã™

```kotlin
package com.example.mycarsensorapp.ui.extensions

import android.widget.ImageView
import androidx.databinding.BindingAdapter
import com.bumptech.glide.Glide

class ImageViewExtension {
    companion object {
        @JvmStatic
        @BindingAdapter("imageUrl")
        fun ImageView.loadImage(imageUrl: String?) {
            if (imageUrl == null) {
                return
            }
            Glide.with(this).load(imageUrl).into(this)
        }
    }
}
```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

- ã„ã–å®Ÿè¡Œï¼

![ã„ã–å®Ÿè¡Œ](./img/3-4.png)

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

- ç”»åƒãŒè¡¨ç¤ºã—ã¦ãã‚Œãªã„
  - ã‚«ãƒ¼ã‚»ãƒ³ã‚µãƒ¼APIãŒè¿”ã™ç”»åƒã®URLãŒHTTPã§ã‚ã‚‹ãŸã‚
    - ClearTextå¯¾å¿œãŒå¿…è¦

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

#### AndroidManifestã®ä¿®æ­£

```xml
    <application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:usesCleartextTraffic="true"
        android:theme="@style/AppTheme">

```

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

- ã„ã–å®Ÿè¡Œï¼

![ã„ã–å®Ÿè¡Œ](./img/3-5.png)

---

## View/ViewModel ã®ä½œæˆ

### æ¤œç´¢çµæœãƒªã‚¹ãƒˆã®å®Ÿè£…

- ã„ã–å®Ÿè¡Œï¼
  - ãƒªã‚¹ãƒˆã‚‚ã‚¿ãƒƒãƒ—ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼

![ã„ã–å®Ÿè¡Œ](./img/3-6.png)

---

## View/ViewModel ã®ä½œæˆ

### å®Œæˆï¼

---

## View/ViewModel ã®ä½œæˆ

### å®Œæˆ......ã ãŒã€å¾Œã‚‚ã†å°‘ã—ã¤ã¥ãã‚“ã˜ã‚ƒã€‚ã€‚ã€‚

---

## 2ã¤ã‚ã®ãƒ“ãƒ¥ãƒ¼ (`UsedCarDetailFragment` / `UsedCarDetailViewModel`) ã®ä½œæˆ

---

## å‚è€ƒè³‡æ–™ç­‰

---

## å‚è€ƒè³‡æ–™ç­‰

- [ModelViewViewModel - Wikipedia](https://ja.wikipedia.org/wiki/Model_View_ViewModel)
- [ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚° - Wikipedia](https://ja.wikipedia.org/wiki/%E3%83%87%E3%83%BC%E3%82%BF%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0)
- [ã‚¢ãƒ—ãƒª ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ ã‚¬ã‚¤ãƒ‰ - AndroidDevelopers](https://developer.android.com/jetpack/guide?hl=ja)
- [Android Architecture Components åˆç´š ï¼ˆ MVVM + LiveData + Coroutines ç·¨ ï¼‰- Qiita](https://qiita.com/Tsutou/items/69a28ebbd69b69e51703#view)

---

## å‚è€ƒè³‡æ–™ç­‰

- [ãƒ“ãƒ¥ãƒ¼ ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚° - AndroidDeveloper](https://developer.android.com/topic/libraries/view-binding?hl=ja)
- [Butter Knifeã€ä»Šã¾ã§ã‚ã‚ŠãŒã¨ã†ã€‚ Data Bindingã€ã“ã‚Œã‹ã‚‰ã‚ˆã‚ã—ãã€‚](https://qiita.com/izumin5210/items/2784576d86ce6b9b51e6)
- [ãƒ“ãƒ«ãƒ‰æ™‚ã«"ã‚¨ãƒ©ãƒ¼:ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸hogehogetest.databindingã¯å­˜åœ¨ã—ã¾ã›ã‚“"ã¨ã‚¨ãƒ©ãƒ¼ã™ã‚‹ - teratail](https://teratail.com/questions/52200)

---

## å‚è€ƒè³‡æ–™ç­‰

- [Kotlin Parcelable ã«ã¤ã„ã¦ - Qiita](https://qiita.com/sadashi/items/fd902619f5b3491e969f)
- [Kotlin ã‚¹ã‚³ãƒ¼ãƒ—é–¢æ•° ç”¨é€”ã¾ã¨ã‚ - Qiita](https://qiita.com/ngsw_taro/items/d29e3080d9fc8a38691e)
- [Kotlinã®companion objectã¨ã¯ - Qiita](https://qiita.com/tkhs0604/items/261e94a42b7097dfd204#:~:text=companion%20object%20%E3%81%AF%E3%82%AF%E3%83%A9%E3%82%B9%E5%86%85,Singleton%E3%81%8C%E4%BD%9C%E6%88%90%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82&text=%E3%81%BE%E3%81%9F%E3%80%81%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E5%90%8D%E3%81%AF%E7%9C%81%E7%95%A5,%E3%81%97%E3%81%AA%E3%81%84%E3%81%93%E3%81%A8%E3%81%8C%E3%81%BB%E3%81%A8%E3%82%93%E3%81%A9%E3%81%A7%E3%81%99%E3%80%82)
- [Kotlinã®data classï¼ˆãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ï¼‰ã®ä½¿ã„æ–¹ã€åˆå¿ƒè€…å‘ã‘ã€‘ - TechAcademy](https://techacademy.jp/magazine/19797)
- [Kotlin ã®ã‚³ãƒ«ãƒ¼ãƒãƒ³å…¥é–€](https://mahata.gitlab.io/post/2019-04-23-coroutines-kotlin/)

---

## å‚è€ƒè³‡æ–™ç­‰

- [Fragment ã® Android-KTX ãŒ AAC ViewModel ã®å–å¾—ã«ä¾¿åˆ©ã ](https://qiita.com/mangano-ito/items/9b067916d1374d66b750)
- [Cannot inline bytecode built with JVM target 1.8 into bytecode that is being built with JVM target 1.6. Please specify proper â€˜-jvm-targetâ€™ option](https://qiita.com/kph7mgb/items/28ee37957976e80e38f219)

---

## å‚è€ƒè³‡æ–™ç­‰

- [Androidã®Spinnerã‚’ã‚³ãƒ¼ãƒ‰ã¨åç§°ã§ç®¡ç†ã—ãŸã„æ™‚ã¯Adapterã‚’ä½¿ãŠã†](https://araramistudio.jimdo.com/2018/02/05/android%E3%81%AEspinner%E3%82%92%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A8%E5%90%8D%E7%A7%B0%E3%81%A7%E7%AE%A1%E7%90%86%E3%81%97%E3%81%9F%E3%81%84%E6%99%82%E3%81%AFadapter%E3%82%92%E4%BD%BF%E3%81%8A%E3%81%86/)
- [[Android & Kotlin] ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã§é …ç›®é¸æŠã§ãã‚‹Spinnerã‚’è¨­å®š](https://akira-watson.com/android/kotlin/spinner-simple.html)

---

## ã”å‚åŠ ã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ

---

## ãŠã‚ã‚Š